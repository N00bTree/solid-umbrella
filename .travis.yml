install:
  - sudo apt-get install -y g++ zlib1g-dev build-essential git python time gawk gettext unzip file libssl-dev wget gcc flex bison libz-dev libncurses-dev make
  - sudo apt install -y ccache automake lzop gperf build-essential zip curl zlib1g-dev zlib1g-dev g++-multilib python-networkx libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev liblz4-tool make optipng
  
language: java

jdk:
  - openjdk8

cache: ccache

addons:
  apt:
    update: true
    packages:
      - oracle-java8-installer

env:
  global:
    - MAKEFLAGS="-j 2"

sudo: false

script:
  - jdk_switcher use openjdk8
  - while sleep 9m; do echo "=====[ $SECONDS seconds build still running ]====="; done &
  - bash build-twrp.sh

before_deploy:
  - export TRAVIS_TAG=${TRAVIS_TAG:-$(date +'%Y%m%d-%H%M')}
  - export RELEASE_NAME=TWRP-OUKITEL-K10
  - git tag $TRAVIS_TAG

deploy:
  provider: releases
  api_key:
    secure: Puof9pLJnApkWf3B3yV4nsC89mQuM3oCh/1DXA+Fymoi1nGCzgSobqMdgQrvVQPsEru9Xu98yUD0qFja98P59xTct3hZZUlicvEsnO63Z2roykH1cr5YnRjdjgWceLTuDq+35zYVqp8sV6WKz/fholpVIcJIxaVm9QP9jrPQCI6nZH8J7oPOc5vNR7YDkgbpaYpOccpE8FXyv0mePrzneNVFueXylTJGSjTJKrJbqmjtOzb9At8cIWvebjggLcbK+GMzPiQd28821xa7lOivmfAtSg6v1mgwDYHNYlxKL4tyWQBDahhLUkhlvGNgmX+fAxNP05+24mnN1O2eLhczTfk9XfoVUgpDPwnk4JmcuNRtWKokphELYyxHTQVM3RrGVadi4WAqwEl02iqOt/QaC+NNKJ7u92oXjPZJgKZy8Nh7SR/7LkpDjMXjx0KqjDdhb+Y9KUWVWDuS5YQS5sbG5fLVD62gKU/MCp6foOwbT5cwP8IV80ssFphg07xbKPQO4xyBCCrUdnuKHdomNpgXbRetNSYQdFqxx9W8oK+j/M2/Dqyjk0+wdPSquu6uK0cVmb+CTNeySC8RUpXl/oHnoS8tXJo17mUQhzXfIBxG4lhEm3S5iKVh+ztTIBBDf8D1G9vtj8+IIdBE21nGOwOcfoq22bGPHXftLe+fQwEdsT0=
  name: ${RELEASE_NAME}
  file_glob: true
  file: /home/travis/twrp/out/target/product/k10/recovery.img
  skip_cleanup: true
  on:
    repo: N00bTree/solid-umbrella
    branch: oukitel-k10